generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        Int    @id @default(autoincrement())
  contact   String @unique
  name      String?
  pdp       String?  // Photo de profil
  pdc       String?  // Photo de couverture
  purchase  String?
  createdAt DateTime @default(now())

  // Relation avec WorkRelation (Entreprise ↔ Worker)
  entreprises WorkRelation[] @relation("EntrepriseWorkerRelation")
  workers     WorkRelation[] @relation("WorkerEntrepriseRelation")

  // Relation avec CustomerRelation (Owner ↔ Customer)
  owners     CustomerRelation[] @relation("OwnerCustomerRelation")
  customers  CustomerRelation[] @relation("CustomerOwnerRelation")
}

model WorkRelation {
  id           Int   @id @default(autoincrement())
  
  workerId     Int
  worker       User @relation("WorkerEntrepriseRelation", fields: [workerId], references: [id])

  entrepriseId Int
  entreprise   User @relation("EntrepriseWorkerRelation", fields: [entrepriseId], references: [id])
}

model CustomerRelation {
  id         Int   @id @default(autoincrement())

  customerId Int
  customer   User @relation("CustomerOwnerRelation", fields: [customerId], references: [id])

  ownerId    Int
  owner      User @relation("OwnerCustomerRelation", fields: [ownerId], references: [id])
}
